#!/bin/bash

APP_ROOT=$(cd $(dirname $0)/..; pwd);
SERVICE_NAME=$(basename $APP_ROOT);

ENV_CONFIG=$APP_ROOT/instance-env.sh
MAIN_PROPERTIES=$APP_ROOT/config.properties
OVERLAY_MAIN_PROPERTIES=$APP_ROOT/overlay-config.properties
UNDEPLOYED_NEWRELIC_CONF=$APP_ROOT/newrelic.yml
UNDEPLOYED_LIB=$APP_ROOT/undeployed-lib
DEPLOYED_LIB=$APP_ROOT/lib
DEPLOYED_NEWRELIC_DIR=$APP_ROOT/newrelic
ROLLBACK_LIB=$APP_ROOT/rollback-lib
ROLLBACK_NEWRELIC_DIR=$APP_ROOT/rollback-newrelic
VAR_DATA=$APP_ROOT/var/data
VAR_LOG=$APP_ROOT/var/log
LOG4J=file://${APP_ROOT}/etc/log4j.properties
LOG_PATH=${APP_ROOT}/var/log

function exit_if_service_is_running()
{
    # is the service already running?
    if ps -efwww | grep -v grep | grep "\-DserviceName="${SERVICE_NAME} > /dev/null
    then
        echo "$SERVICE_NAME service running"
        exit 1
    fi
}


function build_classpath() {
    SERVICE_CLASS_PATH=""
    # create classpath
    for JAR in $DEPLOYED_LIB/*.*;
    do
      if [ "${SERVICE_CLASS_PATH}x" != "x" ]; then
        SERVICE_CLASS_PATH="${SERVICE_CLASS_PATH}:"
      fi
      SERVICE_CLASS_PATH="${SERVICE_CLASS_PATH}${JAR}"
    done
    echo $SERVICE_CLASS_PATH
}